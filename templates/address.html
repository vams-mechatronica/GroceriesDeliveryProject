{% load static %}
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="description" content="">
  <script src="{% static 'js/jquery.js' %}"></script>
  <meta name="author" content="">
  <meta name="generator" content="">
  <title>Home</title>
  <!-- Favicons -->
  <link rel="apple-touch-icon" href="/docs/5.2/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" href="/docs/5.2/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
  <link rel="icon" href="/docs/5.2/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
  <link rel="manifest" href="/docs/5.2/assets/img/favicons/manifest.json">
  <link rel="mask-icon" href="/docs/5.2/assets/img/favicons/safari-pinned-tab.svg" color="#712cf9">
  <link rel="icon" href="/docs/5.2/assets/img/favicons/favicon.ico">
  <meta name="theme-color" content="#712cf9">
  {% comment %} <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css"> {% endcomment %}
  <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="stylesheet" href="{% static 'css/searchpop.css' %}">
  <script src="{% static 'js/bootstrap.js' %}"></script>
  <script src="{% static 'js/input-allow.js' %}"></script>
  <!-- Theme styles for this theme -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.1/font/bootstrap-icons.css">
  <link href="{% static 'theme/css/bootstrap.min.css' %}" rel="stylesheet">
  <!-- Custom styles for this site -->
  <link href="{% static 'css/style.css' %}" rel="stylesheet">
  <link href="{% static 'css/custome.css' %}" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/slick/slick.css' %}">
  <link rel="stylesheet" href="{% static 'css/slick/slick-theme.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
  

</head>

<body>
    <style>
        .address-form {
            border: 1px solid #e5e5e5;
            padding-top: 0  ;
            position: relative;
        }
        .header-goback{
            position: relative;
            padding: 10px;
            background-color: #f1a815;
        }
        .deliver-card{
            border: 1px solid #00a082;
            padding: 20px;
            margin-bottom: 10px;
        }
        .deliver-card p{
            margin-bottom: 5px;
        }
        .default-address{
            color: #00a082;
        }
        .deliver-card a{
            width: max-content;
            padding: 5px 15px;
            border: 1px solid #00a082;
            border-radius: 8px;
            text-decoration: none;
            color: black;
            cursor: pointer;
            transition:0.3s;
            margin-top: 10px;
        }
        .deliver-card a:hover{
            background: #00a082;
            border: 1px solid #00a082;
            color: white;
            transition:0.3s;
        }
        .add_form{
            height: 30vh;
            width: 80%;
            margin: auto;
            background-color: #f7faff;
            position: absolute;
            border: 1px solid #d6d6d6;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
        }
        .center_data{
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        .center_data p{
           margin-top: 30px;
           color: #00a082;
        }
        .center_data span{
            position: absolute;
            left: 50%;
            top: 20%;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid #a5a5a5;
            background-color: white;
            transform: translate(-50%, -50%);
        }
        .center_data span::after{
            position: absolute;
            content: "+";
            left: 50%;
            top: 40%;
            color: #00a082;
            transform: translate(-50%, -50%);
        }
        .header-goback button{
            position: absolute;
            top: 10px;
            left: 10px;
            border-radius: 8px;
            font-size: 12px;
            padding: 15px 25px;
            }
            .header-goback button::before{
            position: absolute;
            content: "";
            top: 10px;
            left: 10px;
            height: 10px;
            width: 10px;
            left: 15px;
            border: none;
            border-left: 2px solid black;
            border-bottom: 2px solid black;
            transform: rotate(45deg);
            }
            .header-goback button::after{
            position: absolute;
            content: "";
            top: 6px;
            left: 10px;
            height: 10px;
            width: 20px;
            left: 15px;
            border: none;
            border-bottom: 2px solid black;
            }
        .default-box{
            position: relative;
        }
        .default-box label{
            position: absolute;
            top: 5px;
            display: none;
            font-size: 12px;
            color: #f7cb07ee;
            margin-left: 5px;
            transition: all 1s ease-out;
        }
        .default-box input{
            width: 100%;
            border: none;
            border-bottom: 1px solid #e5e5e5;
            border-radius: 0;
            color: rgb(129, 129, 129);
            padding: 3px 15px;
        }
        .default-box select{
            width: 100%;
            border: none;
            border-bottom: 1px solid #e5e5e5;
            border-radius: 0;
            color: rgb(129, 129, 129);
            padding: 3px 15px;
        }
        .default-box textarea{
            width: 100%;
            border: none;
            border-bottom: 1px solid #e5e5e5;
            border-radius: 0;
            color: rgb(129, 129, 129);
        }
        .default-box input::placeholder{
           font-size: 14px;
        }
        .choose_address_type .btn-check:checked {
            color: white !important;
        }
        .btn-address a{
            width: 100%;
            padding: 5px 0;
            text-align: center;
            background-color: rgb(213, 213, 213);
            color: black;
            border-radius: 8px;
            text-decoration: none;
        }
        .btn-address a.active{
            background-color: #00a082;
            color: white;
        }
        .btn-outline-warning{
            color: #00a082;
            border: 1px solid #00a082;
        }
        .btn-outline-warning:hover{
            color: #00a082;
            border: 1px solid #00a082;

        }

        .choose_address_type .btn input[type="radio"]:checked+.btn-outline-warning {
            background-color: #007bff;
            color: #00a082;
            border: 1px solid #00a082;
        }

        @keyframes slideUp {
            0%,
            50% {
              transform: translateY(100%);
              opacity: 0;
            }
             
            51%,
            100% {
              transform: translateY(0);
              opacity: 1;
            
            }
          }
        @media(max-width:500px) and (min-width:300px){
            .add_form {
                position: relative;
                height: 10vh;
                width: 100%;
                top: 50px;
            }
            .center_data span {
                top: 30px;
            }
            .center_data span::after {
                left: 55%;
                top: 40%;
            }
            .center_data p {
                margin-top: 35px;
            }
            .address-form {
                border-bottom: none;
                padding-bottom: 0;
                border: none;
            }
            .header-goback{
            position: relative;
            padding: 10px;
            }
            .header-goback button{
            position: absolute;
            top: 13px;
            left: 10px;
            border-radius: 8px;
            padding: 12px 25px;
            }
            .header-goback button::before{
            position: absolute;
            content: "";
            top: 8px;
            left: 10px;
            height: 8px;
            width: 8px;
            left: 15px;
            border: none;
            border-left: 2px solid black;
            border-bottom: 2px solid black;
            transform: rotate(45deg);
            }
            .header-goback button::after{
            position: absolute;
            content: "";
            top: 7.9px;
            left: 10px;
            height: 5px;
            width: 15px;
            left: 15px;
            border: none;
            border-bottom: 2px solid black;
            }
            .address-form h4{
                margin-top: 10px;
                font-size: 18px;
            }
            .default-box {
                padding: 5px;
            }
            .choose_address_type {
                margin-bottom: 6px;
                
            }
            .btn-address a{
                width: 100%;
                padding: 5px 0;
                text-align: center;
                background-color: rgb(213, 213, 213);
                color: black;
                border-radius: 8px;
                text-decoration: none;
            }
            .btn-address a.active{
                background-color: #00a082;
                color: white;
            }
            .choose_address_type p{
                font-size: 14px;
                margin-bottom: 5px;
            }
        }
        a{
            color: black;
        }
        a.delete{
            color: red;
        }
    </style>
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} auto-dismiss">
                {{ message }}
            </div>
        {% endfor %}
        <script>
            setTimeout(function() {
                $('.auto-dismiss').fadeOut('slow');
            }, 3000);
        </script>
    {% endif %}
    <div class="header-goback">
        <button onclick="window.history.back()"></button>
        <h3 class="text-center text-light">
            Add New Address
        </h3>
    </div>
    <div class="body container d-flex flex-wrap">
        <div class="address-form p-xl-2 p-lg-2 p-md-2 col-xl-6 col-lg-6 col-md-8 col-12 my-xl-4" id="form_add">
            <form method="post" id="user_address_form" action="{% url 'user-address-page' %}">
                {% csrf_token %}
                <h4>Personal Details</h4>
                <div class="personal-details">
                    <div class="d-flex">
                        <div class="col-6 default-box">
                            <label for="first_name"><span class="danger">*</span>First Name</label>
                            <input type="text" onkeyup="change_lable(this)" name="first_name" id="first_name" placeholder="*First Name">
                            
                        </div>
                        <div class="col-6 default-box">
                            <label for="last_name"><span class="danger">*</span> Last Name</label>
                            <input type="text" onkeyup="change_lable(this)" name="last_name" id="last_name" placeholder="*Last Name">
                        </div>
                    </div>
                    <div class="number default-box col-12">
                        <label for="phone"><span class="danger">*</span> Contact number to say Namaste!</label>
                        <input type="text" onkeyup="change_lable(this)" name="phone" id="phone" placeholder="*Contact number to say Namaste!">
                    </div>
                </div>
                <div class="address-details">
                    <h4>Address Details</h4>
                    <div class="d-flex">
                        <div class="default-box col-6">
                            <label for="Pincode"><span class="danger">*</span>Pincode</label>
                            <select name="Pincode" id="Pincode">
                                <option value="201301">Select Pincode</option>
                                {% for pincode in store_locations %}
                                <option value="{{pincode}}">{{pincode}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="default-box col-6">
                            <label for="house_no"><span class="danger">*</span>House no</label>
                            <input type="text" onkeyup="change_lable(this)" name="house_no" id="house_no" placeholder="*House/Flat no">
                        </div>
                    </div>
                    <div class="default-box col-12">
                        <label for="area_detail"><span class="danger">*</span> Area details</label>
                        <select name="area_detail" id="area_detail">
                            <option value="Noida">Select Area</option>
                            {% for sl in area %}
                            <option value="{{sl.comb_area}}">{{sl.comb_area}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="default-box col-12">
                        <label for="street_address">Street details to locate you</label>
                        <textarea type="text" rows="1" onkeyup="change_lable(this)" name="street_address" id="street_address" placeholder="Locality/ Street Name/ Apartment*"></textarea>
                    </div>
                    <div class="default-box col-12">
                        <label for="landmark_detail">Landmark*</label>
                        <textarea type="text" rows="1" onkeyup="change_lable(this)" name="landmark_detail" id="landmark_detail" placeholder="Landmark*"></textarea>
                    </div>
                    <div class="d-flex">
                        <div class="default-box col-6">
                            <label for="state">State*</label>
                            <input type="text" onkeyup="change_lable(this)" name="state" id="state" placeholder="State*">
                        </div>
                        <div class="default-box col-6">
                            <label for="city_district">City/District</label>
                            <input type="text" onkeyup="change_lable(this)" name="city_district" id="city_district" placeholder="City/District">
                        </div>
                    </div>
                    <div class="choose_address_type col-12 btn-group btn-group-toggle" role="group" name="address_nick" data-toggle="buttons">
                        <p>Choose a Nick Name: </p>
                        <input type="radio" class="btn-check" name="address_nick" id="Home" value="Home">
                        <label for="Home" class="btn btn-outline-warning ms-3">Home</label>
                        
                        <input type="radio" class="btn-check" name="address_nick" id="Office" value="Office">
                        <label for="Office" class="btn btn-outline-warning ms-3"> Office </label>
                       
                        <input type="radio" class="btn-check" name="address_nick" id="Others" value="Others">
                        <label for="Others" class="btn btn-outline-warning ms-3">Other</label> 
                        
                    </div>
                    <br>
                    <br>
                </div>
                <div class="btn-address">
                    {% comment %} <a onclick="checkForm('user_address_form'); event.preventDefault(); document.getElementById('user_address_form').submit();" class="active button" id="form-button">Add Address</a> {% endcomment %}
                    <a onclick="checkForm('user_address_form'); event.preventDefault();" class="active button" id="form-button">Add Address</a>
                </div>
            </form>
        </div>
        {% if addresses %}
        <div class="col-xl-6 col-lg-6  col-12 px-xl-4 px-lg-4 px-md-4 mt-4">
            <div class="address-form p-xl-2 p-lg-2 p-md-2">
                <h4>Saved Address </h4>
                {% for addr in addresses %}
                <div class="col-xl-12 col-lg-12 col-md-12 col-12 deliver-card">
                    {% if addr.default_address is True %}
                    <h6><span class="default-address"><b>Default:</b></span>&nbsp; {{addr.address_nick_name}}</h6>
                    {% else %}
                    <h6>{{addr.address_nick_name}}</h6>
                    {% endif %}
                    <p><b>Contact Name:</b>&nbsp; {{addr.contact_name}}</p>
                    <p><b>Address:</b>&nbsp; {{addr.user_address}}</p>
                    <p><b>M. No.:</b>&nbsp; {{addr.mobileno}}</p>
                    {% comment %} <a href="{% url 'deliver-here' num=2 pk=addr.id %}" class="deliver here active">Deliver Here</a>  {% endcomment %}
                    <a onclick="deliver_here_cookie({{addr.id}})" class="deliver here active deliver-here-btn">Deliver Here</a> 
                    &nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <a onclick="edit_address({{addr.id}})">
                    <span class="bi bi-pencil-square"></span>
                    </a>
                    <a href="{% url 'delete-address' addr.id %}" class="delete">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>

    <script>
        function change_lable(el){
            $(el).removeAttr('placeholder')
            console.log()
            if ($(el).val().length ==0){
                $(el).prev().hide()    
                $(el).attr('placeholder',$(el).prev().text())
            }
            else{
                $(el).prev().show().css( {"top": "0px", "transition" : "all 1s ease-out" ,"animation-name": "slideUp",            "animation-duration": "0.3s", "animation-timing-function": "ease-in"});
            }
        }
        function checkForm(id_form){
            console.log("working")
            if(!$('#first_name').val()){
                $('#first_name').focus()
            }
            else if(!$('#last_name').val()){
                $('#last_name').focus()
            }
            else if(!$('#phone').val()){
                $('#phone').focus()
            }
            else if(!$('#house_no').val()){
                $('#house_no').focus()
            }
            else if(!$('#street_address').val()){
                $('#street_address').focus()
            }
            else if(!$('#landmark_detail').val()){
                $('#landmark_detail').focus()
            }
            else if(!$('#area_detail').val()){
                $('#area_detail').focus()
            }
            else if(!$('#city_district').val()){
                $('#city_district').focus()
            }
            else if(!$('#Pincode').val()){
                $('#Pincode').focus()
            }
            else{
                $('#user_address_form').submit()
            }
        }
        var getCookie = function (name) {
            var cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        };
        
        function deliver_here_cookie(e){
            var deliver_here = getCookie('deliver_here')
            var redirect_url = getCookie('redirect_page')

            if (deliver_here == null || deliver_here == undefined){
                deliver_here = e
                document.cookie = 'deliver_here=' +deliver_here+ ";domain=;path=/;expires=" + new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toUTCString();
                if (redirect_url === "cart"){
                    window.location.href = "{% url 'cartview' %}";
                }
                else if(redirect_url === "address"){
                    window.location.href = "{% url 'user-address-page' %}";
                }
            } else {
                deliver_here = e
                document.cookie = 'deliver_here=' +deliver_here+ ";domain=;path=/;expires=" + new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toUTCString();
                if (redirect_url === "cart"){
                    window.location.href = "{% url 'cartview' %}";
                }
                else if(redirect_url === "address"){
                    window.location.href = "{% url 'user-address-page' %}";
                }
            }
        }
        const g_csrftoken = getCookie('csrftoken');
        function edit_address(id){
            domain = window.location.origin
            path_name = '/api/v1/accounts/api/v1/user-address/'+id+'/'
            $.ajax({
            type: 'GET',
            url: domain+path_name,
            data: {
                "csrfmiddlewaretoken":g_csrftoken,
            },
            success: function(response) {
                if (response){
                    $('#form_add').empty()
                    $('#form_add').append(`<form method="post" id="user_address_form" action="update/`+response['id']+`/">
                {% csrf_token %}
                <h4>Personal Details</h4>
                <div class="personal-details">
                    <div class="d-flex">
                        <div class="col-6 default-box">
                            <label for="first_name"><span class="danger">*</span>First Name</label>
                            <input type="text" onkeyup="change_lable(this)" name="first_name" id="first_name" value="`+response['first_name']+`">
                            
                        </div>
                        <div class="col-6 default-box">
                            <label for="last_name"><span class="danger">*</span> Last Name</label>
                            <input type="text" onkeyup="change_lable(this)" name="last_name" id="last_name" value="`+response['last_name']+`">
                        </div>
                    </div>
                    <div class="number default-box col-12">
                        <label for="phone"><span class="danger">*</span> Contact number to say Namaste!</label>
                        <input type="text" onkeyup="change_lable(this)" name="phone" id="phone" value="`+response['mobileno']+`">
                    </div>
                </div>
                <div class="address-details">
                    <h4>Address Details</h4>
                    <div class="d-flex">
                        <div class="default-box col-6">
                            <label for="Pincode"><span class="danger">*</span>Pincode</label>
                            <select name="Pincode" id="Pincode">
                                <option value="`+response['pincode']+`">`
                                    +response['pincode']+`</option>
                                {% for pincode in store_locations %}
                                <option value="{{pincode.pincode}}">{{pincode.pincode}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="default-box col-6">
                            <label for="house_no"><span class="danger">*</span>House no</label>
                            <input type="text" onkeyup="change_lable(this)" name="house_no" id="house_no" value="`+response['house_no']+`">
                        </div>
                    </div>
                    <div class="default-box col-12">
                        <label for="area_detail"><span class="danger">*</span> Area details</label>
                        <select name="area_detail" id="area_detail">
                            <option value="`+response['area']+`">`+response['area']+`</option>
                            {% for sl in store_locations %}
                            <option value="{{sl.comb_area}}">{{sl.comb_area}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="default-box col-12">
                        <label for="street_address">Street details to locate you</label>
                        <textarea type="text" rows="1" onkeyup="change_lable(this)" name="street_address" id="street_address">`+response['street_detail']+`</textarea>
                    </div>
                    <div class="default-box col-12">
                        <label for="landmark_detail">Landmark*</label>
                        <textarea type="text" rows="1" onkeyup="change_lable(this)" name="landmark_detail" id="landmark_detail">`+response['landmark']+`</textarea>
                    </div>
                    <div class="d-flex">
                        <div class="default-box col-6">
                            <label for="state">State*</label>
                            <input type="text" onkeyup="change_lable(this)" name="state" id="state" value="`+response['state']+`">
                        </div>
                        <div class="default-box col-6">
                            <label for="city_district">City/District</label>
                            <input type="text" onkeyup="change_lable(this)" name="city_district" id="city_district" value="`+response['city']+`">
                        </div>
                    </div>
                    <div class="choose_address_type col-12 btn-group btn-group-toggle" role="group" name="address_nick" data-toggle="buttons">
                        <p>Choose a Nick Name: </p>
                        <input type="radio" class="btn-check" name="address_nick" id="Home" value="Home">
                        <label for="Home" class="btn btn-outline-warning ms-3">Home</label>
                        
                        <input type="radio" class="btn-check" name="address_nick" id="Office" value="Office">
                        <label for="Office" class="btn btn-outline-warning ms-3"> Office </label>
                       
                        <input type="radio" class="btn-check" name="address_nick" id="Others" value="Others">
                        <label for="Others" class="btn btn-outline-warning ms-3">Other</label> 
                        
                    </div>
                    <br>
                    <br>
                </div>
                <div class="btn-address">
                    <a onclick="checkForm('user_address_form'); event.preventDefault();" class="active button" id="form-button">Add Address</a>
                </div>
            </form>`)
                    

                    }
                }
            })
        }
        $(window).on('load', function () {
            var redirect_url = getCookie('redirect_page')
            if (redirect_url == "address"){
                $('.deliver-here-btn').css('visibility', 'hidden');
            }
        });
    </script>
    <!-- Core javascript for this theme -->
    <script src="{% static 'theme/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/jquery.js' %}"></script>
    <!-- Custom JavaScript for this site -->
    <link href="{% static 'js/home.js' %}" rel="stylesheet">
    <link href="{% static 'css/home.css' %}" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script src="{% static 'css/slick/slick.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>
    <script src="{% static 'assets/js/bootstrap.js' %}"></script>
    <script src="{% static 'assets/js/jquery.js' %}"></script>
    <script src="{% static 'js/jquery.bootstrap.modal.forms.js' %}"></script>
    <!-- You can alternatively load the minified version -->
    <script src="{% static 'js/jquery.bootstrap.modal.forms.min.js' %}"></script>
</body>
</html>